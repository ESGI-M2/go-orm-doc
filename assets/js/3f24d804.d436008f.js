"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6998],{2660:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"technical/dialectes","title":"Gestion des dialectes","description":"Cette page d\xe9taille l\'impl\xe9mentation des dialectes (MySQL, PostgreSQL, Mock).","source":"@site/docs/technical/dialectes.md","sourceDirName":"technical","slug":"/technical/dialectes","permalink":"/go-orm-doc/docs/technical/dialectes","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Gestion des dialectes"},"sidebar":"docs","previous":{"title":"Architecture g\xe9n\xe9rale","permalink":"/go-orm-doc/docs/technical/architecture"},"next":{"title":"M\xe9tadonn\xe9es & R\xe9flexion","permalink":"/go-orm-doc/docs/technical/metadata"}}');var l=n(4848),r=n(8453);const t={sidebar_position:2,sidebar_label:"Gestion des dialectes"},c="Gestion des dialectes",d={},o=[{value:"Fonctionnalit\xe9s Go utilis\xe9es",id:"fonctionnalit\xe9s-go-utilis\xe9es",level:2},{value:"Packages standards",id:"packages-standards",level:3},{value:"Concepts Go avanc\xe9s",id:"concepts-go-avanc\xe9s",level:3},{value:"Patterns Go idiomatiques",id:"patterns-go-idiomatiques",level:3},{value:"Interface <code>Dialect</code>",id:"interface-dialect",level:2},{value:"MySQLDialect",id:"mysqldialect",level:2},{value:"PostgreSQLDialect",id:"postgresqldialect",level:2},{value:"MockDialect",id:"mockdialect",level:2},{value:"SQL Type mapping (extrait)",id:"sql-type-mapping-extrait",level:2},{value:"Placeholders",id:"placeholders",level:2},{value:"S\xe9curit\xe9 &amp; Pr\xe9paration",id:"s\xe9curit\xe9--pr\xe9paration",level:2},{value:"Extension : ajouter un nouveau dialecte",id:"extension--ajouter-un-nouveau-dialecte",level:2}];function a(e){const s={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.header,{children:(0,l.jsx)(s.h1,{id:"gestion-des-dialectes",children:"Gestion des dialectes"})}),"\n",(0,l.jsx)(s.p,{children:"Cette page d\xe9taille l'impl\xe9mentation des dialectes (MySQL, PostgreSQL, Mock)."}),"\n",(0,l.jsx)(s.h2,{id:"fonctionnalit\xe9s-go-utilis\xe9es",children:"Fonctionnalit\xe9s Go utilis\xe9es"}),"\n",(0,l.jsx)(s.h3,{id:"packages-standards",children:"Packages standards"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"database/sql"})," : Interface de base avec les drivers de base de donn\xe9es"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"reflect"})," : Analyse des types Go pour le mapping SQL"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"strings"})," : Construction et manipulation des requ\xeates SQL"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"fmt"})," : Formatage des erreurs et des cha\xeenes SQL"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.code,{children:"sync"})," : Protection des connexions partag\xe9es"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"concepts-go-avanc\xe9s",children:"Concepts Go avanc\xe9s"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Interfaces"})," : ",(0,l.jsx)(s.code,{children:"Dialect"})," d\xe9finit le contrat pour tous les dialectes"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Type assertion"})," : Conversion s\xfbre des r\xe9sultats SQL vers les types Go"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Embedding"})," : Base commune via ",(0,l.jsx)(s.code,{children:"BaseDialect"})," embarqu\xe9e"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"M\xe9thodes pointeur"})," : Gestion de l'\xe9tat de la connexion"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Closures"})," : Wrapping des transactions et des pr\xe9parations"]}),"\n"]}),"\n",(0,l.jsx)(s.h3,{id:"patterns-go-idiomatiques",children:"Patterns Go idiomatiques"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Driver pattern"})," : Impl\xe9mentation du standard ",(0,l.jsx)(s.code,{children:"database/sql/driver"})]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Error handling"})," : Wrapping des erreurs sp\xe9cifiques aux bases"]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Connection pooling"})," : Utilisation idiomatique de ",(0,l.jsx)(s.code,{children:"sql.DB"})]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Resource cleanup"})," : Fermeture syst\xe9matique avec ",(0,l.jsx)(s.code,{children:"defer"})]}),"\n",(0,l.jsxs)(s.li,{children:[(0,l.jsx)(s.strong,{children:"Interface segregation"})," : Interfaces minimales par responsabilit\xe9"]}),"\n"]}),"\n",(0,l.jsxs)(s.h2,{id:"interface-dialect",children:["Interface ",(0,l.jsx)(s.code,{children:"Dialect"})]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-go",children:"type Dialect interface {\n    GetName() string\n    Connect(cfg interfaces.ConnectionConfig) error\n    Close() error\n    Ping() error\n\n    // Transactions\n    Begin() (*sql.Tx, error)\n    Commit() error\n    Rollback() error\n\n    // SQL helpers\n    GetPlaceholder(pos int) string\n    GetSQLType(goType reflect.Type) string\n\n    // Ex\xe9cution brute\n    Exec(query string, args ...interface{}) (sql.Result, error)\n    Query(query string, args ...interface{}) (*sql.Rows, error)\n}\n"})}),"\n",(0,l.jsx)(s.h2,{id:"mysqldialect",children:"MySQLDialect"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Utilise le driver ",(0,l.jsx)(s.code,{children:"github.com/go-sql-driver/mysql"}),"."]}),"\n",(0,l.jsxs)(s.li,{children:["Placeholders : ",(0,l.jsx)(s.code,{children:"?"}),"."]}),"\n",(0,l.jsxs)(s.li,{children:["Mapping types Go \u2192 MySQL (",(0,l.jsx)(s.code,{children:"INT"}),", ",(0,l.jsx)(s.code,{children:"BIGINT"}),", ",(0,l.jsx)(s.code,{children:"VARCHAR"}),", etc.)."]}),"\n",(0,l.jsxs)(s.li,{children:["G\xe8re ",(0,l.jsx)(s.code,{children:"CREATE DATABASE IF NOT EXISTS"})," lors de l'auto-cr\xe9ation."]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"postgresqldialect",children:"PostgreSQLDialect"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["Driver ",(0,l.jsx)(s.code,{children:"github.com/lib/pq"}),"."]}),"\n",(0,l.jsxs)(s.li,{children:["Placeholders : ",(0,l.jsx)(s.code,{children:"$1"}),", ",(0,l.jsx)(s.code,{children:"$2"}),", \u2026"]}),"\n",(0,l.jsxs)(s.li,{children:["Support des types sp\xe9cifiques (",(0,l.jsx)(s.code,{children:"TEXT"}),", ",(0,l.jsx)(s.code,{children:"BYTEA"}),", ",(0,l.jsx)(s.code,{children:"SERIAL"}),")."]}),"\n",(0,l.jsxs)(s.li,{children:["Gestion du sch\xe9ma avec ",(0,l.jsx)(s.code,{children:"CREATE SCHEMA IF NOT EXISTS"}),"."]}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"mockdialect",children:"MockDialect"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"Connexion simul\xe9e en m\xe9moire."}),"\n",(0,l.jsx)(s.li,{children:"Toutes les m\xe9thodes retournent des valeurs factices."}),"\n",(0,l.jsx)(s.li,{children:"Utilis\xe9 dans les tests unitaires pour isoler la logique ORM."}),"\n"]}),"\n",(0,l.jsx)(s.h2,{id:"sql-type-mapping-extrait",children:"SQL Type mapping (extrait)"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Go"}),(0,l.jsx)(s.th,{children:"MySQL"}),(0,l.jsx)(s.th,{children:"PostgreSQL"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"int"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"INT"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"INTEGER"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"int64"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"BIGINT"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"BIGINT"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"string"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"VARCHAR(255)"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"VARCHAR"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"bool"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"TINYINT(1)"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"BOOLEAN"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"time.Time"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"DATETIME"})}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"TIMESTAMP"})})]})]})]}),"\n",(0,l.jsx)(s.h2,{id:"placeholders",children:"Placeholders"}),"\n",(0,l.jsxs)(s.table,{children:[(0,l.jsx)(s.thead,{children:(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.th,{children:"Dialect"}),(0,l.jsx)(s.th,{children:"Exemple"})]})}),(0,l.jsxs)(s.tbody,{children:[(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"MySQL"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"INSERT INTO users (name) VALUES (?)"})})]}),(0,l.jsxs)(s.tr,{children:[(0,l.jsx)(s.td,{children:"PostgreSQL"}),(0,l.jsx)(s.td,{children:(0,l.jsx)(s.code,{children:"INSERT INTO users (name) VALUES ($1)"})})]})]})]}),"\n",(0,l.jsx)(s.h2,{id:"s\xe9curit\xe9--pr\xe9paration",children:"S\xe9curit\xe9 & Pr\xe9paration"}),"\n",(0,l.jsxs)(s.p,{children:["Les placeholders emp\xeachent l'injection SQL en s\xe9parant code et donn\xe9es. Chaque Dialect pr\xe9pare les requ\xeates en utilisant ",(0,l.jsx)(s.code,{children:"database/sql"}),"."]}),"\n",(0,l.jsx)(s.h2,{id:"extension--ajouter-un-nouveau-dialecte",children:"Extension : ajouter un nouveau dialecte"}),"\n",(0,l.jsxs)(s.ol,{children:["\n",(0,l.jsxs)(s.li,{children:["Impl\xe9mentez l'interface ",(0,l.jsx)(s.code,{children:"Dialect"}),"."]}),"\n",(0,l.jsxs)(s.li,{children:["Ajoutez le mapping dans ",(0,l.jsx)(s.code,{children:"factory.CreateDialect"}),"."]}),"\n",(0,l.jsx)(s.li,{children:"Fournissez les helpers types / placeholders."}),"\n",(0,l.jsx)(s.li,{children:"Ajoutez des tests unitaires."}),"\n"]}),"\n",(0,l.jsx)(s.hr,{}),"\n",(0,l.jsxs)(s.blockquote,{children:["\n",(0,l.jsxs)(s.p,{children:["Les dialectes assurent la portabilit\xe9 : changez simplement le ",(0,l.jsx)(s.code,{children:"ConfigBuilder"})," pour cibler une autre base de donn\xe9es."]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(a,{...e})}):a(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>c});var i=n(6540);const l={},r=i.createContext(l);function t(e){const s=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);