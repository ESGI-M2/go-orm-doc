"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3156],{5654:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"technical/architecture","title":"Architecture g\xe9n\xe9rale","description":"Cette page d\xe9crit la structure interne de GO ORM et la fa\xe7on dont les packages interagissent.","source":"@site/docs/technical/architecture.md","sourceDirName":"technical","slug":"/technical/architecture","permalink":"/go-orm-doc/docs/technical/architecture","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Architecture g\xe9n\xe9rale"},"sidebar":"docs","previous":{"title":"Exemples d\'Utilisation Avanc\xe9e","permalink":"/go-orm-doc/docs/library/examples"},"next":{"title":"Gestion des dialectes","permalink":"/go-orm-doc/docs/technical/dialectes"}}');var i=s(4848),t=s(8453);const c={sidebar_position:1,sidebar_label:"Architecture g\xe9n\xe9rale"},d="Architecture g\xe9n\xe9rale",o={},l=[{value:"Fonctionnalit\xe9s Go utilis\xe9es",id:"fonctionnalit\xe9s-go-utilis\xe9es",level:2},{value:"Packages standards",id:"packages-standards",level:3},{value:"Concepts Go avanc\xe9s",id:"concepts-go-avanc\xe9s",level:3},{value:"Patterns Go idiomatiques",id:"patterns-go-idiomatiques",level:3},{value:"D\xe9coupage des packages",id:"d\xe9coupage-des-packages",level:2},{value:"Flux de connexion",id:"flux-de-connexion",level:2},{value:"Strat\xe9gies de conception",id:"strat\xe9gies-de-conception",level:2}];function a(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"architecture-g\xe9n\xe9rale",children:"Architecture g\xe9n\xe9rale"})}),"\n",(0,i.jsx)(n.p,{children:"Cette page d\xe9crit la structure interne de GO ORM et la fa\xe7on dont les packages interagissent."}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TD\n    subgraph Dialectes\n        MySQL["MySQL Dialect"]\n        PostgreSQL["PostgreSQL Dialect"]\n        Mock["Mock Dialect"]\n    end\n\n    subgraph Core\n        Connection["connection"]\n        Metadata["metadata"]\n        Query["query (builders)"]\n        Repository["repository"]\n        Transaction["transaction"]\n    end\n\n    Builder["builder (SimpleORM / AdvancedORM)"]\n\n    Builder --\x3e Connection\n    Builder --\x3e Dialectes\n    Builder --\x3e Metadata\n\n    Repository --\x3e Query\n    Repository --\x3e Metadata\n    Query --\x3e Dialectes\n    Transaction --\x3e Connection'}),"\n",(0,i.jsx)(n.h2,{id:"fonctionnalit\xe9s-go-utilis\xe9es",children:"Fonctionnalit\xe9s Go utilis\xe9es"}),"\n",(0,i.jsx)(n.h3,{id:"packages-standards",children:"Packages standards"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"database/sql"})," : Interface standard de Go pour les bases de donn\xe9es SQL"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"reflect"})," : Utilis\xe9 pour l'introspection des structures et l'extraction des m\xe9tadonn\xe9es"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"sync"})," : Gestion du cache de m\xe9tadonn\xe9es thread-safe avec ",(0,i.jsx)(n.code,{children:"sync.Map"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"context"})," : Support des contextes pour les op\xe9rations de base de donn\xe9es"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"errors"})," : Gestion avanc\xe9e des erreurs avec ",(0,i.jsx)(n.code,{children:"errors.Is"})," et ",(0,i.jsx)(n.code,{children:"errors.As"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"concepts-go-avanc\xe9s",children:"Concepts Go avanc\xe9s"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Interfaces"})," : D\xe9couplage fort via des interfaces comme ",(0,i.jsx)(n.code,{children:"Dialect"}),", ",(0,i.jsx)(n.code,{children:"Repository"}),", ",(0,i.jsx)(n.code,{children:"QueryBuilder"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Generics"})," : Utilis\xe9s dans le Repository pour un typage fort (",(0,i.jsx)(n.code,{children:"Repository[T]"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Composition"})," : Les structures embarquent d'autres structures pour la r\xe9utilisation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"M\xe9thodes pointeur/valeur"})," : Choix strat\xe9gique selon les besoins de mutation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"init()"})," : Initialisation des dialectes et enregistrement dans la factory"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"defer"})," : Gestion propre des ressources (connexions, transactions)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"patterns-go-idiomatiques",children:"Patterns Go idiomatiques"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Builder pattern"})," : Configuration fluide de l'ORM"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Factory method"})," : Cr\xe9ation des dialectes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Options pattern"})," : Configuration flexible via des fonctions options"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Error wrapping"})," : Enrichissement du contexte des erreurs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Middleware pattern"})," : Pour les hooks et les transactions"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"d\xe9coupage-des-packages",children:"D\xe9coupage des packages"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Package"}),(0,i.jsx)(n.th,{children:"R\xf4le"}),(0,i.jsx)(n.th,{children:"D\xe9pendances principales"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/builder"})}),(0,i.jsx)(n.td,{children:"Cr\xe9e et configure l'ORM (pattern Builder)"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"orm/core/*"}),", ",(0,i.jsx)(n.code,{children:"orm/dialect"}),", ",(0,i.jsx)(n.code,{children:"orm/factory"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/core/connection"})}),(0,i.jsx)(n.td,{children:"G\xe8re la connexion DB, pooling"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/dialect"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/core/metadata"})}),(0,i.jsx)(n.td,{children:"Extrait les m\xe9tadonn\xe9es via r\xe9flexion, met en cache"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"reflect"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/core/query"})}),(0,i.jsx)(n.td,{children:"Implemente le Query Builder"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"orm/dialect"}),", ",(0,i.jsx)(n.code,{children:"gorm/core/metadata"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/core/repository"})}),(0,i.jsx)(n.td,{children:"Fournit le CRUD, scopes, hooks"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"orm/core/query"}),", ",(0,i.jsx)(n.code,{children:"orm/core/metadata"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/core/transaction"})}),(0,i.jsx)(n.td,{children:"Encapsule les transactions"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/core/connection"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/dialect"})}),(0,i.jsx)(n.td,{children:"D\xe9finit l'interface Dialect ; impl\xe9mentations MySQL/PostgreSQL/Mock"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"database/sql"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/factory"})}),(0,i.jsx)(n.td,{children:"Fabrique de dialectes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"orm/dialect"})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"flux-de-connexion",children:"Flux de connexion"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SimpleORM"})," appelle ",(0,i.jsx)(n.strong,{children:"builder.Connect()"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["Le Builder cr\xe9e une ",(0,i.jsx)(n.strong,{children:"Connection"})," avec le Dialect choisi."]}),"\n",(0,i.jsxs)(n.li,{children:["Le Dialect ouvre un ",(0,i.jsx)(n.code,{children:"*sql.DB"})," et configure le pool."]}),"\n",(0,i.jsxs)(n.li,{children:["Les ",(0,i.jsx)(n.strong,{children:"Metadata"})," sont extraites et mises en cache."]}),"\n",(0,i.jsxs)(n.li,{children:["Les tables sont cr\xe9\xe9es/migr\xe9es si ",(0,i.jsx)(n.code,{children:"WithAutoCreateDatabase"})," est activ\xe9."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"strat\xe9gies-de-conception",children:"Strat\xe9gies de conception"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Inversion de d\xe9pendance"})," : les couches haut-niveau (Repository) d\xe9pendent d'interfaces (QueryBuilder, Dialect) plut\xf4t que d'impl\xe9mentations."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"R\xe9flexion contr\xf4l\xe9e"})," : uniquement lors de l'extraction des m\xe9tadonn\xe9es, r\xe9sultat mis en cache pour \xe9viter les surco\xfbts."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Cha\xeenage fluide"})," : toutes les m\xe9thodes Builder retournent le receveur pour simplifier la configuration."]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Pour plus de d\xe9tails sur chaque Dialecte, voir la page suivante."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>d});var r=s(6540);const i={},t=r.createContext(i);function c(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);